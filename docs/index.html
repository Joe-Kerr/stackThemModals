<!DOCTYPE html>
<html lang="en">
	<head>		
		<meta charset="UTF-8" />
		
		<meta http-equiv="cache-control" content="no-cache" />
		<meta http-equiv="expires" content="0">
		<meta http-equiv="pragma" content="no-cache">			
		
		<meta http-equiv="Content-Security-Policy" content="default-src 'self'; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline'" />
				
		<script src="./stackThemModals.browser.js"></script>
		
		<style>
		
		.hier1 {
			width: 200px;
		}
		
		ul > li {
			outline: 1px solid black;
			min-height: 20px;
			list-style: none;
		}
		


		</style>
	</head>

<body>

<ul class="hier1">
	<li id="test5">test5</li>
	<li id="test4">
		test4
		<ul class="hier2">
			<li id="test6">test6</li>
			<li id="test3">
				test3
				<ul class="hier3">
					<li></li>
					<li id="test2">
						test2
						<ul class="hier4">
							<li id="test1">test1</li>
						</ul>
					</li>
					<li></li>
				</ul>				
			</li>
			<li></li>
		</ul>	
	</li>
	<li></li>
</ul>

<p>
"test1" is a modal element on top of the modal element "test2" which is a modal element on top of "test3".
</p>

<p>Clicking outside "test3" destroys modal behaviour for all three modal elemets.</p>
<p>Clicking outside "test2" but on or inside "test3" destroys modal behaviour for "test2" and "test1". [etc.]</p>

<button onclick="window.location.reload()">Reset</button>

<script>
(function() {
	
	Array.prototype.slice.call(document.getElementsByTagName("li")).forEach((el)=>{el.style.backgroundColor="white";});
	
	let actives = 0;
	let id = 0;
	
	function heat(x, min, max) {
		const norm = (x - min) / (max - min);
		const hue = (1.0 - norm) * 240;
		return 'hsl('+hue+', 100%, 50%)';
	}	
	
	function enable(_el, ms) {		
		const el = document.getElementById(_el);
		ms.push(el, ()=>{console.log("click outside", el.id); el.style.backgroundColor="grey";});
		actives++;
		id++;
		let _id = id;
		setTimeout(()=>{
			el.style.backgroundColor = heat(_id, 1, actives);
		}, 1);
	}
	
	const ms = stackThemModals.default;
	enable("test1", ms);
	enable("test2", ms);
	enable("test3", ms);
})()
</script>

</body>
</html>